name: Analyze Brand Style
description: Invokes the brand_style_analysis Cloud Function.

inputs:
- {name: project, type: String, description: 'GCP Project ID'}
- {name: location, type: String, description: 'GCP Location for the function'}
- {name: gcs_image_uris, type: JsonArray, description: 'List of GCS paths to brand creative images'}
- {name: gcs_output_uri, type: String, description: 'GCS path to write the output JSON'}

outputs:
- {name: gcs_output_path, type: String, description: 'The GCS path of the generated analysis file'}

implementation:
  container:
    image: google/cloud-sdk:slim
    command:
    - sh
    - -c
    - |
      set -e -x
      gcloud functions call analyze_brand_style \
        --region=$0 \
        --data='{"project": "'"$1"'", "location": "'"$2"'", "gcs_image_uris": '"$3"', "gcs_output_uri": "'"$4"'"}'
      echo $4 > $5
    args:
    - {inputValue: location}
    - {inputValue: project}
    - {inputValue: location}
    - {inputValue: gcs_image_uris}
    - {inputValue: gcs_output_uri}
    - {outputPath: gcs_output_path}